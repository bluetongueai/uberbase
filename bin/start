#! /bin/bash
platform=$(uname -m)
if [ $platform = "x86_64" ]; then
  sudo chmod 666 /dev/kvm
fi
source .env
./bin/configure
echo -e "\033[33mBuilding api for platform $platform...\033[0m"
./bin/build
echo -e "\033[33mStarting uberbase...\033[0m"

export UBERBASE_PLATFORM="`arch | sed s/arm64/aarch64/ | sed s/amd64/x86_64/`"
echo "Starting on $UBERBASE_PLATFORM"

./functions/api/bin/api ./configs/functions/config.json 2>&1 | tee ./logs/uberbase.log
