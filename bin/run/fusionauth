#! /bin/bash

podman run \
    -d \
    --restart unless-stopped \
    --name fusionauth \
    --replace \
    --env-file ${UBERBASE_VAULT_STORAGE}/credentials \
    --env VAULT_ADDR=https://uberbase:${UBERBASE_VAULT_PORT} \
    --env FUSIONAUTH_APP_URL=${UBERBASE_FUSIONAUTH_APP_URL} \
    --env FUSIONAUTH_ENVIRONMENT=development \
    --env FUSIONAUTH_APP_KICKSTART_FILE=/usr/local/fusionauth/kickstart/kickstart.json \
    -v ${PWD}/_configs/fusionauth/kickstart:/usr/local/fusionauth/kickstart \
    -v ${PWD}/_configs/fusionauth/config:/usr/local/fusionauth/config \
    --network host \
    --add-host uberbase:0.0.0.0 \
    uberbase.local/uberbase-fusionauth:latest

podman logs -f fusionauth
